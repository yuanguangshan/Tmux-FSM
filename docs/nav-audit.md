# 规性审计 · 执行结果（Sample）

## 原始输入表（复述，作为审计基线）

| Key | 行为 | 类别 | 备注 |
|----|----|----|----|
| h | focus pane left | Spatial | — |
| j | focus pane down | Spatial | — |
| k | focus pane up | Spatial | — |
| g | enter GOTO | Transition | — |
| : | enter command mode | Transition | — |
| Esc | return to NAV | Transition | — |
| w | close pane | ??? | ⚠️ |

---

## 一、逐键三段式审计结果

---

### ✅ `h / j / k`

**规则编号映射**  
- ✅ NAV-020.1（空间级导航）

**语义污染检测**  
- Vim Normal Mode 中：
  - `h j k` = 光标移动
  - 在 tmux NAV 中用于 pane 移动 → **语义同构**
- ✅ 肌肉记忆连续

**时间维度测试**  
- 单步、原子、无状态
- 不涉及子层或回退逻辑

✅ **结论：A. 完全合规（Safe）**

> ✅ 可在代码中标注：  
> `// NAV-020.1: Spatial navigation, semantic-aligned`

---

### ✅ `g → enter GOTO`

**规则编号映射**  
- ✅ NAV-020.2（模式跃迁）

**语义污染检测**  
- Vim 中 `g` 是前缀键，但：
  - 这里是**显式模式跃迁**
  - 不执行编辑语义
- ✅ 可接受（这是“入口键”，不是编辑键）

**时间维度测试**  
- 若 GOTO：
  - 有超时
  - Esc / 完成后 → 回到 NAV  
✅ 满足 NAV-030

✅ **结论：A. 完全合规（Safe）**

> 这是一个**标准教科书级的 NAV → 子层入口**。

---

### ✅ `: → enter command mode`

**规则编号映射**  
- ✅ NAV-020.2（模式跃迁）

**语义污染检测**  
- Vim 中 `:` = Command-line mode
- 在 tmux 中也进入“命令态”
- ✅ **语义高度一致**

**时间维度测试**  
- CMD 完成 / Esc / 超时 → NAV  
✅

✅ **结论：A. 完全合规（Safe）**

> 这是**跨系统语义对齐的典范案例**。

---

### ✅ `Esc → return to NAV`

**规则编号映射**  
- ✅ NAV-030（唯一回归目标）

**语义污染检测**  
- Esc = 退出 / 取消
- ✅ 全生态一致

**时间维度测试**  
- 强制回归 NAV
- 不依赖上下文

✅ **结论：A. 完全合规（Safe）**

> Esc 是 **NAV 的宪法级按键**。

---

### ❌ `w → close pane`

这一条非常关键。

---

#### 1️⃣ 规则编号映射（失败）

- ❌ 不属于 NAV-020.1（不是导航）
- ❌ 不属于 NAV-020.2（不是模式跃迁）
- ❌ 不属于 NAV-020.3（不是主权让渡）

✅ **第一关直接失败**

---

#### 2️⃣ 语义污染检测（致命）

- Vim Normal Mode：
  - `w` = **word forward**
  - 高频、深度肌肉记忆键

在 NAV 中拦截 `w`：

> **用户会在 Vim 中下意识按 `w`，却关闭了 pane**

这是**明确的语义越权**。

❌ **违反 NAV-010（Semantic Exclusion Zone）**

---

#### 3️⃣ 时间维度测试（次要，但仍失败）

- 关闭 pane 是**破坏性操作**
- 非瞬态、不可逆
- 不应存在于 NAV 的“默认安全态”

---

### ❌ 结论：C. 明确违规（Violation）

> **必须立即移除或迁移**

---

## 二、审计输出清单（你可以直接存档）

### ✅ A. 完全合规（Safe）

- `h / j / k` → Spatial Navigation
- `g` → Enter GOTO
- `:` → Enter CMD
- `Esc` → Return to NAV

---

### ⚠️ B. 灰区（Smell）

> **无**（这是一个非常健康的信号）

---

### ❌ C. 明确违规（Violation）

- `w → close pane`
  - 违反：NAV-010 / NAV-020 / 设计意图
  - 行动：**移出 NAV**

---

## 三、推荐整改方案（不止“删掉”）

你有三个**合规选项**，按推荐度排序：

### ✅ 方案 1（最推荐）

- 将 `close pane` 移入 **CMD 层**
- 例如：
  ```
  :q
  :close
  ```

✅ 破坏性操作 → 显式命令 → 语义安全

---

### ✅ 方案 2

- 放入 **GOTO 子层**
- 例如：
  ```
  g → x
  ```

⚠️ 前提：GOTO 是**短时、显式、可取消的**

---

### ❌ 方案 3（不推荐）

- 换成别的单键放在 NAV

> ❌ 问题不在于“w 不合适”，  
> 而在于 **NAV 根本不应该承载这个行为**。

---

## 四、一个非常重要的判断信号（你已经触发了）

> 当你发现：
> **“这个键功能挺方便，但就是放不进 NAV 规则里”**

✅ 说明规则是对的  
✅ 说明 NAV 已经形成了免疫力

---
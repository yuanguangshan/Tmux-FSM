# logic.go: FSM 状态机核心

`logic.go` 实现了 FOEK 的核心调度逻辑：有限状态机 (FSM)。

## 核心职责

1. **输入归位**：将原始按键映射为 `motion`, `operator`, `count` 等语义单元。
2. **状态转移**：处理从 `NORMAL` 到 `OPERATOR_PENDING` 等多个核心状态的转换。
3. **意图生成**：根据当前状态和输入，产生可执行的 `action` 字符串。
4. **按键序列管理**：处理按键序列的记录和清除。

## 状态机模型

- **NORMAL**: 入口状态。
- **OPERATOR_PENDING**: 等待操作范围。
- **REGISTER_SELECT**: 等待寄存器指定。
- **VISUAL_CHAR**: 字符选择模式。
- **VISUAL_LINE**: 行选择模式。
- **MOTION_PENDING**: 等待复合移动（如 `gg`）。
- **FIND_CHAR**: 等待查找字符（f/F/t/T）。
- **TEXT_OBJECT_PENDING**: 等待文本对象类型（i/a + 对象类型）。
- **SEARCH**: 搜索模式。

## 支持的操作

- **基础移动**: h/j/k/l, w/b/e, 0/$, gg/G, ^等
- **操作符**: d(delete), y(yank), c(change)
- **视觉模式**: v/V 进入字符/行选择模式
- **文本对象**: i/a + w/b/(/[/{/"/'/` 等
- **查找**: f/F/t/T + 字符
- **搜索**: / + 搜索词, n/N
- **重复**: . (重复最后的操作)

## 优势

- **解耦**：逻辑与执行完全分离。
- **原子性**：结合 `main.go` 中的互斥锁，确保每个转化的状态唯一且安全。
- **扩展性**: 易于添加新的状态和操作。
